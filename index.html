<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Catch Nicky!</title>
  <style>
    :root { --scale: 4; }
    body {
      margin: 0;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      background: #0b1020;
      color: #e8e8ff;
      display: grid;
      place-items: center;
      height: 100vh;
      overflow: hidden;
    }
    .frame {
      width: min(92vw, 480px);
      border: 4px solid #e8e8ff;
      border-radius: 16px;
      padding: 14px;
      background: #121a33;
      box-shadow: 0 10px 40px rgba(0,0,0,.35);
    }
    h1 { font-size: 18px; margin: 0 0 6px; letter-spacing: .5px; }
    .sub { font-size: 12px; opacity: .85; margin-bottom: 10px; }
    .hud { display:flex; justify-content:space-between; font-size: 12px; margin: 6px 0 10px; opacity:.9; }
    .arena {
      position: relative;
      width: 100%;
      height: 360px;
      border: 3px solid #e8e8ff;
      border-radius: 14px;
      background: repeating-linear-gradient(0deg, #101833 0, #101833 12px, #0f1730 12px, #0f1730 24px);
      overflow: hidden;
      user-select: none;
      touch-action: none;
    }
    /* pixel rendering */
    img.pixel { image-rendering: pixelated; image-rendering: crisp-edges; }

    .target {
      position: absolute;
      width: calc(24px * var(--scale));
      height: calc(24px * var(--scale));
      cursor: pointer;
      transform: translate(-50%, -50%);
      filter: drop-shadow(0 6px 10px rgba(0,0,0,.35));
    }

    .btnrow { display:flex; gap:10px; margin-top: 10px; }
    button {
      flex: 1;
      padding: 10px 12px;
      border: 2px solid #e8e8ff;
      background: #1a2550;
      color: #e8e8ff;
      border-radius: 12px;
      font-weight: 700;
      cursor: pointer;
    }
    button:hover { filter: brightness(1.08); }

    .modal {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,.55);
      display: none;
      place-items: center;
      padding: 18px;
      z-index: 20;
    }
    .card {
      width: min(92vw, 520px);
      background: #121a33;
      border: 4px solid #e8e8ff;
      border-radius: 16px;
      padding: 14px;
      text-align: center;
    }
    .card h2 { margin: 0 0 8px; font-size: 16px; }
    .card p { margin: 0 0 12px; font-size: 12px; opacity: .9; line-height: 1.4; }
    .rewardImg {
      width: min(70vw, 280px);
      height: auto;
      border: 3px solid #e8e8ff;
      border-radius: 14px;
      background: #0b1020;
      margin: 10px auto;
      display:block;
    }
    a.dl {
      display:inline-block;
      margin-top: 8px;
      padding: 10px 12px;
      border: 2px solid #e8e8ff;
      background: #1a2550;
      color: #e8e8ff;
      border-radius: 12px;
      text-decoration: none;
      font-weight: 700;
    }
    a.dl:hover { filter: brightness(1.08); }
    .tiny { font-size: 11px; opacity: .75; margin-top: 8px; }
  </style>
</head>
<body>
  <div class="frame">
    <h1>Catch Nicky!</h1>
    <div class="sub">Click the pixel Nicky <b>5</b> times to win âœ¨</div>

    <div class="hud">
      <div>Hits: <span id="hits">0</span>/5</div>
      <div>Tries: <span id="tries">0</span></div>
    </div>

    <div class="arena" id="arena">
      <!-- Replace icon.png with your pixel icon file -->
      <img class="target pixel" id="target" src="icon.png" alt="Nicky pixel icon">
    </div>

    <div class="btnrow">
      <button id="startBtn">Start</button>
      <button id="resetBtn">Reset</button>
    </div>
  </div>

  <!-- Modal -->
  <div class="modal" id="modal">
    <div class="card" id="card"></div>
  </div>

<script>
(() => {
  const arena = document.getElementById("arena");
  const target = document.getElementById("target");
  const hitsEl = document.getElementById("hits");
  const triesEl = document.getElementById("tries");
  const startBtn = document.getElementById("startBtn");
  const resetBtn = document.getElementById("resetBtn");
  const modal = document.getElementById("modal");
  const card = document.getElementById("card");

  const HITS_TO_WIN = 5;
  let hits = 0;
  let tries = 0;
  let running = false;
  let vx = 2.6, vy = 2.1; // speed
  let x = 120, y = 120;
  let raf = null;

  function clamp(n, a, b) { return Math.max(a, Math.min(b, n)); }

  function sizeOfTarget() {
    const r = target.getBoundingClientRect();
    return { w: r.width, h: r.height };
  }

  function arenaBounds() {
    const r = arena.getBoundingClientRect();
    return { w: r.width, h: r.height };
  }

  function placeTarget() {
    target.style.left = x + "px";
    target.style.top = y + "px";
  }

  function step() {
    if (!running) return;
    const { w: aw, h: ah } = arenaBounds();
    const { w: tw, h: th } = sizeOfTarget();
    const padX = tw/2 + 6;
    const padY = th/2 + 6;

    x += vx;
    y += vy;

    if (x <= padX || x >= aw - padX) vx *= -1;
    if (y <= padY || y >= ah - padY) vy *= -1;

    x = clamp(x, padX, aw - padX);
    y = clamp(y, padY, ah - padY);

    placeTarget();
    raf = requestAnimationFrame(step);
  }

  function start() {
    if (running) return;
    running = true;
    // randomize initial direction a bit
    vx = (Math.random() > 0.5 ? 1 : -1) * (2.2 + Math.random()*1.6);
    vy = (Math.random() > 0.5 ? 1 : -1) * (2.0 + Math.random()*1.4);
    raf = requestAnimationFrame(step);
  }

  function reset() {
    running = false;
    if (raf) cancelAnimationFrame(raf);
    raf = null;
    hits = 0; tries = 0;
    hitsEl.textContent = hits;
    triesEl.textContent = tries;

    const { w: aw, h: ah } = arenaBounds();
    x = aw * 0.5;
    y = ah * 0.5;
    placeTarget();
    hideModal();
  }

  function showModal(html) {
    card.innerHTML = html;
    modal.style.display = "grid";
  }
  function hideModal() {
    modal.style.display = "none";
    card.innerHTML = "";
  }

  function winSequence() {
    running = false;
    if (raf) cancelAnimationFrame(raf);

    // 1) allowance prank
    showModal(`
      <h2>ðŸŽ‰ You win!</h2>
      <p>Your prize isâ€¦</p>
      <p style="font-size:14px"><b>You must send me my allowance.</b></p>
      <div class="tiny">(Tap anywhere to continue)</div>
    `);

    const step1 = () => {
      modal.removeEventListener("click", step1);
      // 2) just kidding
      showModal(`
        <h2>ðŸ˜¼ Just kidding.</h2>
        <p>Real prize: <b>a picture of your favourite sibling.</b></p>
        <button id="next1">Continue</button>
      `);
      document.getElementById("next1").onclick = () => reward1();
    };

    modal.addEventListener("click", step1);
  }

  function reward1() {
    // Replace reward_me.png later
    showModal(`
      <h2>Reward 1</h2>
      <p><b>A picture of your favourite sibling.</b></p>
      <img class="rewardImg pixel" src="reward_me.png" alt="Reward 1">
      <a class="dl" href="reward_me.png" download>Download this reward</a>
      <div style="margin-top:12px">
        <button id="next2">Continue</button>
      </div>
    `);
    document.getElementById("next2").onclick = () => reward2();
  }

  function reward2() {
    // Replace reward_family.png later
    showModal(`
      <h2>Reward 2</h2>
      <p><b>Actuallyâ€¦ this oneâ€™s the real prize.</b></p>
      <img class="rewardImg pixel" src="reward_family.png" alt="Reward 2">
      <a class="dl" href="reward_family.png" download>Download this reward</a>
      <div style="margin-top:12px">
        <button id="done">Play again</button>
      </div>
      <div class="tiny">P.S. I miss you ðŸ’™</div>
    `);
    document.getElementById("done").onclick = () => { hideModal(); reset(); start(); };
  }

  // Clicking the target
  target.addEventListener("click", (e) => {
    e.stopPropagation();
    if (!running) return;
    hits++;
    tries++;
    hitsEl.textContent = hits;
    triesEl.textContent = tries;

    // tiny speed-up makes it feel gamey
    vx *= 1.03; vy *= 1.03;

    if (hits >= HITS_TO_WIN) winSequence();
  });

  // miss click = try counter (optional)
  arena.addEventListener("click", () => {
    if (!running) return;
    tries++;
    triesEl.textContent = tries;
  });

  startBtn.onclick = start;
  resetBtn.onclick = reset;

  // init
  reset();
})();
</script>
</body>
</html>
